(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{422:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this.$createElement;return(this._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:this.isOpenMap,expression:"isOpenMap"}],class:this.parseWrapperClasses,attrs:{id:this.mapboxID}})};a._withStripped=!0;var i=n(4),s=n.n(i),r=n(7),o=n.n(r),c=n(8),l=n.n(c),p=n(3),u=n.n(p),d=n(1),m=n.n(d),g=n(590),h=n.n(g),f=(n(591),n(531)),v=n(532),y=n(533);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={name:"wil-mapbox",mixins:[f.a,v.a],computed:{mapboxID:function(){var e=(new Date).getTime();return"wil-mapbox-".concat(e)},queryArgs:function(){var e="access_token=".concat(this.parseAccessToken,"&limit=1");return this.parseLanguage.length&&(e="".concat(e,"&language=").concat(this.parseLanguage)),e}},created:function(){this.getMapSizeIcon()},methods:{addMoveMapWhenHoveringControl:function(){var e=this;this.instance.addControl({onAdd:function(t){return e.moveOnMapControl=document.createElement("div"),e.moveOnMapControl.className="wilcity-wrapper-search-as-move-map mapboxgl-ctrl",new y.a(e.moveOnMapControl,WILCITY_I18.searchAsIMoveTheMap).handling=function(t){e.isSearchAsIMoveTheMap=t},e.moveOnMapControl},onRemove:function(){e.moveOnMapControl.parentNode.removeChild(e.moveOnMapControl),e.instance=void 0}},"top-left")},prepareNewLayers:function(e){var t=this,n={type:"FeatureCollection",features:[]};return e.map((function(e){n=b(b({},n),{},{features:[].concat(u()(n.features),[t.addLayer(e)])})})),n},searchOnMapMove:function(){var e=this,t={};this.instance.on("dragend",(function(n){if(!e.isSearchAsIMoveTheMap)return!1;_.isEmpty(t)||clearTimeout(t),t=setTimeout((function(){e.isDropping=!0;var n,a,i=e.instance.getBounds();n=i.getSouthWest(),a=i.getNorthEast();var s=["".concat(n.lat,",").concat(n.lng),"".concat(a.lat,",").concat(a.lng)];e.$emit("dragend",{bound:s}),clearTimeout(t)}))}))},buildMapLayers:function(){if(!this.items.length)return this.notifyMsg({type:"info",msg:"There is no item or the item does not have Latitude and Longitude"}),!1;var e=this.prepareNewLayers(this.items),t=this.addMarkers(e);this.flyTo(t)},addLayer:function(e){return{type:"Feature",geometry:{type:"Point",coordinates:{lat:parseFloat(e.oAddress.lat),lon:parseFloat(e.oAddress.lng)}},properties:{iconSize:[50,50],marker:e.oAddress.marker,item:e}}},getMapSizeIcon:function(){if(void 0===("undefined"==typeof WILOKE_GLOBAL?"undefined":l()(WILOKE_GLOBAL))||_.isEmpty(WILOKE_GLOBAL.mapSizeIcon))this.iconSize={width:"100px",height:"100px"};else{var e=WILOKE_GLOBAL.mapSizeIcon.split("x");this.iconSize={width:e[0]+"px",height:e[1]+"px"}}},createPopup:function(e){var t=this,n=document.createElement("div");n.className="marker",n.style.backgroundImage="url("+e.properties.marker+")",n.style.backgroundRepeat="no-repeat",n.style.width=this.iconSize.width,n.style.height=this.iconSize.height;var a=new h.a.Popup({offset:10,postID:e.properties.item.postID,anchor:"bottom",closeButton:!1,className:"wil-mapbox-popup"}).setLngLat([e.geometry.coordinates.lon,e.geometry.coordinates.lat]).setHTML(this.buildPopupTemplate(e.properties.item));return a.on("open",(function(e){t.isShowingPopupID=e.target.options.postID})),{el:n,marker:a}},togglePopup:function(e,t){this.isMarkerAdded(e)&&(this.markersCollection[e].togglePopup(),this.isShowingPopupID=e,t.oAddress&&t.oAddress.lat&&t.oAddress.lng&&this.flyTo([t.oAddress.lng,t.oAddress.lat]))},addGetDirectionButton:function(){var e=this;if(!this.listingGgmapUrl.length)return!1;this.instance.addControl({onAdd:function(t){var n=document.createElement("div");n.className="wil-get-direction-button-wrapper",n.style.top="10px",n.style.left="10px";var a=document.createElement("i");a.className="fa fa-map wil-get-direction-icon";var i=document.createElement("a");return i.innerHTML=WILCITY_I18.getDirection,i.href=e.listingGgmapUrl,i.target="_blank",i.style.color="#fff",n.appendChild(a),n.appendChild(i),n}},"top-left")},addMarkers:function(e){var t=this;return e.features.forEach((function(e){var n=e.properties.item.postID;if(!t.isMarkerAdded(n)){var a=t.createPopup(e),i=new h.a.Marker(a.el).setLngLat(e.geometry.coordinates).setPopup(a.marker).addTo(t.instance);t.markersCollection=b(b({},t.markersCollection),{},m()({},n,i))}})),e.features[0].geometry.coordinates},getAddress:function(e){var t=this;return o()(s.a.mark((function n(){var a,i;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a="https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(e.lng,",").concat(e.lat,".json?").concat(t.queryArgs),i=null,n.next=4,Vue.axios.get(a).then((function(e){if(e.data.features.length){var t=e.data.features[0];i={lat:t.center[1],lng:t.center[0],address:t.place_name}}})).catch((function(e){}));case 4:return n.abrupt("return",i);case 5:case"end":return n.stop()}}),n)})))()},determineAddress:function(e){var t=this;return o()(s.a.mark((function n(){var a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getAddress(e);case 2:a=n.sent,t.model=null===a?b(b({},t.model),{},{address:"",lng:e.lng,lat:e.lat}):b({},a);case 4:case"end":return n.stop()}}),n)})))()},flyTo:function(e){null!==this.instance&&(this.instance.flyTo({center:e}),this.marker&&this.marker.setLngLat(e))},addSingleMarker:function(){var e=this,t={draggable:!0,anchor:"center"};if(this.parseMarkerUrl.length){var n=document.createElement("div");n.className="marker";var a=document.createElement("img");a.src=this.parseMarkerUrl,n.style.width=this.iconSize.width,n.style.height=this.iconSize.height,n.appendChild(a),t.element=n}this.marker=new h.a.Marker(t).setLngLat([this.parseCenter.lng,this.parseCenter.lat]).addTo(this.instance),this.marker.on("dragend",(function(){e.determineAddress(e.marker.getLngLat())})),this.instance.on("click",(function(t){e.marker.setLngLat([t.lngLat.lng,t.lngLat.lat]),e.determineAddress(e.marker.getLngLat())}))},init:function(){var e=this;if(null!==this.instance)return!1;setTimeout((function(){h.a.accessToken=e.parseAccessToken;var t={container:e.mapboxID,style:e.parseStyle,center:[e.parseCenter.lng,e.parseCenter.lat],zoom:e.parseDefaultZoom,minZoom:e.parseMinZoom,maxZoom:e.parseMaxZoom};e.mapBoundInfo.isUsingMapBound&&(t=b(b({},t),{},{maxBounds:[[e.mapBoundInfo.start.lng,e.mapBoundInfo.start.lat],[e.mapBoundInfo.end.lng,e.mapBoundInfo.end.lat]]})),e.instance=new h.a.Map(t),e.instance.addControl(new h.a.NavigationControl),e.instance.addControl(new h.a.FullscreenControl),e.isMultiple?(e.buildMapLayers(),e.addMoveMapWhenHoveringControl(),e.searchOnMapMove(),setTimeout((function(){jQuery(window).trigger("resize")}),1e3)):(e.addSingleMarker(),e.addGetDirectionButton())}),this.waitBeforeExecuting)}},mounted:function(){this.isOpenMap=this.isAutoOpenMap}},O=(n(593),n(0)),k=Object(O.a)(L,a,[],!1,null,null,null);k.options.__file="assets/dev/js/components/dumbs/map/WilMapbox.vue";t.default=k.exports},531:function(e,t,n){"use strict";var a=n(1),i=n.n(a);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a={data:function(){return{isOpenMap:!1,instance:null,marker:null,iconSize:{},isShowingPopupID:null,markersCollection:{},markers:{},isSearchAsIMoveTheMap:!0,items:[],instGeocode:{},isWaitingForInstance:!1}},watch:{items:{handler:function(e){null!==e&&(null===this.instance?this.init():this.buildMapLayers())},deep:!0},mouseOnItem:{handler:function(e){if(_.isEmpty(e))return null!==this.isShowingPopupID&&this.togglePopup(this.isShowingPopupID,e),!1;this.togglePopup(e.postID,e)},deep:!0},rawItems:{handler:function(e){this.items=this.rawItems.filter((function(e){return!(_.isEmpty(e.oAddress)||_.isEmpty(e.oAddress.lat)||_.isEmpty(e.oAddress.lng))}))},immediate:!0,deep:!0},latLng:{handler:function(e){_.isUndefined(e.lat)||_.isUndefined(e.lng)||""===e.lat||""===e.lng||this.flyTo(e)}}},props:{isMultiple:{type:Boolean,default:!1},mouseOnItem:{type:Object,default:function(){}},mouseLeaveItem:{type:Object,default:function(){}},panTo:{type:Object,default:function(){}},maxZoom:{type:Number,default:24},minZoom:{type:Number,default:0},defaultZoom:{type:Number,default:10},markerUrl:{type:String,default:""},wrapperClasses:{type:String,default:"wil-map-container"},mapStyle:{type:String,default:"mapbox://styles/mapbox/streets-v11"},markerSvg:{type:String,default:""},accessToken:{type:String,required:!0},restrict:{type:String,default:""},settings:{type:Object,default:function(){}},isAutoOpenMap:{type:Boolean,default:!0},rawItems:{type:Array,default:function(){return[]}},latLng:{type:Object,default:function(){return{lat:"",lng:""}}},isFullWidth:{type:Boolean,default:!0},waitBeforeExecuting:{type:Number,default:0},language:{type:String,default:"en"},listingGgmapUrl:{type:String,default:""}},computed:{model:{get:function(){return this.latLng},set:function(e){this.$emit("change",e)}},parseWrapperClasses:function(){var e=this.wrapperClasses;return this.isFullWidth&&(e="wil-full-width ".concat(e)),e},parseCenter:function(){return!_.isEmpty(this.latLng)&&this.latLng.lat.length&&this.latLng.lng.length?this.latLng:_.isEmpty(WILOKE_GLOBAL.defaultMapCenter)?{lat:21.027763,lng:105.83416}:WILOKE_GLOBAL.defaultMapCenter},parseStyle:function(){return this.settings&&this.settings.mapStyle&&this.settings.mapStyle.length?this.settings.mapStyle:_.isUndefined(this.mapStyle)||!this.mapStyle.length?"mapbox://styles/mapbox/streets-v11":this.mapStyle},parseAccessToken:function(){return this.settings&&this.settings.accessToken?this.settings.accessToken:this.accessToken},parseMinZoom:function(){return this.settings&&this.settings.minZoom?parseInt(this.settings.minZoom,10):this.minZoom},parseMaxZoom:function(){return this.settings&&this.settings.maxZoom?parseInt(this.settings.maxZoom,10):this.maxZoom},parseDefaultZoom:function(){return this.settings&&this.settings.defaultZoom?parseInt(this.settings.defaultZoom,10):this.defaultZoom},parseMarkerUrl:function(){return this.settings&&this.settings.markerUrl?this.settings.markerUrl:this.markerUrl},parseLanguage:function(){return this.settings&&this.settings.language?this.settings.language:this.language},parseToken:function(){return this.settings&&this.settings.accessToken?this.settings.accessToken:this.accessToken},parseRestrict:function(){return this.settings&&this.settings.restrict?this.settings.restrict:this.restrict},mapBoundInfo:function(){var e=null,t=null,n={isUsingMapBound:!1};return WILOKE_GLOBAL.isUseMapBound&&"yes"==WILOKE_GLOBAL.isUseMapBound&&(WILOKE_GLOBAL.mapBoundStart&&WILOKE_GLOBAL.mapBoundStart.length&&(e=WILOKE_GLOBAL.mapBoundStart.split(","),n=r(r({},n),{},{start:{lat:e[0],lng:e[1]}})),WILOKE_GLOBAL.mapBoundEnd&&WILOKE_GLOBAL.mapBoundEnd.length&&(t=WILOKE_GLOBAL.mapBoundEnd.split(","),n=r(r({},n),{},{end:{lat:t[0],lng:t[1]}})),n=r(r({},n),{},{isUsingMapBound:!0})),n}},methods:{isMarkerAdded:function(e){return this.markersCollection[e]},correctLatLng:function(e){return{lat:parseFloat(e.lat,10),lng:e.lon?parseFloat(e.lon,10):parseFloat(e.lng,10)}}},created:function(){this.isOpenMap=this.isAutoOpenMap}}},532:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={methods:{buildPopupTemplate:function(e){e.oReviews?_.isUndefined(e.oReviews.mode)||5!=e.oReviews.mode?e.oReviews.dataRated=e.oReviews.average:e.oReviews.dataRated=2*e.oReviews.average:(e.oReviews={},e.oReviews.dataRated=0,e.oReviews.average=0,e.oReviews.mode=10);var t="";t=e.logo.length?e.logo:e.featuredImage;var n="color-primary";_.isUndefined(e.oBusinessHours)||(n="open"==e.oBusinessHours.status?"color-secondary":"color-primary");var a=e.mapInfo&&e.mapInfo.popup?e.mapInfo.popup.title:e.title,i=e.mapInfo&&e.mapInfo.popup?e.mapInfo.popup.excerpt:e.excerpt,s=e.mapInfo?e.mapInfo.permalink:e.permalink;return'<div class="listing-item-map_module__1FxWL active">\n    <header class="listing-item-map_header__3vj9H">\n      <div class="marker_module__2Kxbk marker_lg__3Ep3w">\n        <div class="marker_background__47Zv3"><img src="'.concat(this.markerSvg,'"/></div><a href="').concat(s,'">\n          <div class="marker_thumb__2NXEV" style="background-image: url(\'').concat(t,'\')"><img src="').concat(t,'" alt="').concat(a,'"></div></a>\n      </div>\n    </header>\n    <div class="listing-item-map_body__2rREN arrow--right-center">\n    ').concat(0!=e.oReviews.average&&e.oReviews.average?'<div class="rated-small_module__1vw2B listing-item-map_rated__1qxUX">\n        <div class="rated-small_wrap__2Eetz" data-rated="'.concat(e.oReviews.dataRated,'">\n          <div class="rated-small_overallRating__oFmKR">').concat(e.oReviews.average,'</div>\n          <div class="rated-small_ratingWrap__3lzhB">\n            <div class="rated-small_maxRating__2D9mI">').concat(e.oReviews.mode,'</div>\n            <div class="rated-small_ratingOverview__2kCI_">').concat(e.oReviews.quality,"</div>\n          </div>\n        </div>\n      </div>\n      "):"","\n                ").concat(e.logo?'\n      <a class="listing-item-map_logo__24mCj bg-cover" href="'.concat(s,'" style="background-image: url(\'').concat(e.logo,"')\"></a>\n      "):"\n                ",'\n      <div class="listing-item-map_content__14yl8">\n        <h2 class="listing-item-map_title__3jqN3 text-ellipsis"><a href="').concat(s,'">').concat(a,'</a></h2>\n        <div class="listing-item-map_tagline__3uiVK text-ellipsis">\n          ').concat(i,'\n        </div>\n      </div>\n      <div class="listing-item-map_foot__P2CrB wil-shadow">\n          ').concat(e.oBusinessHours?'\n        <div class="listing-item-map_footLeft__2Sfw0"><span class="'.concat(n,'">').concat(e.oBusinessHours.text,"</span>\n        "):"\n        ","\n        ").concat(e.priceRange?'\n                    <span class="wilcity-map-price-range color-primary wilcity-price-range-'.concat(e.priceRangeType,'">').concat(e.priceRange,"</span>\n                     "):"\n                    ","\n        ").concat(e.price?'\n                    <span class="wilcity-map-price color-primary wilcity-single-price">'.concat(e.price,"</span>\n                     "):"\n                    ","\n      </div>\n    </div>\n  </div>\n  ")}}}},533:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e,t){var n=this,a=document.createElement("div");a.style.backgroundColor="#fff",a.style.border="2px solid #fff",a.style.borderRadius="3px",a.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",a.style.cursor="pointer",a.style.marginBottom="22px",a.style.textAlign="center",e.appendChild(a);var i=document.createElement("label");i.setAttribute("for","wilcity-map-auto-refresh-checkbox"),i.setAttribute("class","wilcity-wrapper-map-auto-refresh-checkbox");var s=document.createElement("INPUT");s.type="checkbox",s.setAttribute("id","wilcity-map-auto-refresh-checkbox"),s.setAttribute("checked",!0);var r=document.createElement("small");r.setAttribute("class","wrapper-small");var o=document.createElement("span");o.innerHTML=t,r.appendChild(o),i.appendChild(s),i.appendChild(r),a.appendChild(i),s.addEventListener("change",(function(e){var t=jQuery(e.target).is(":checked");n.handling(t)}))};a.prototype.handling=function(e){}},546:function(e,t,n){var a=n(594);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n(15).default)("62ab1736",a,!1,{})},593:function(e,t,n){"use strict";n(546)},594:function(e,t,n){(e.exports=n(14)(!1)).push([e.i,".wil-full-width{overflow:hidden}@media (min-width: 1200px){.wil-box01{position:relative;max-width:820px;width:auto;z-index:10}}@media (min-width: 1200px){.wil-box02{width:calc(100% - 820px);height:100vh}}.wil-show-map{position:static}.wil-mapbox-popup{left:50px}\n",""])}}]);