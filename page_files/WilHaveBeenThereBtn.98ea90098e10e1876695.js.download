(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{684:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("wil-link",{attrs:{icon:e.icon,"btn-name":e.btnName,"is-loading":e.isLoading,"wrapper-classes":[e.wrapperClasses,"yes"===e.toggleChecked?"color-quaternary":"color-primary",e.isLoading?"":"wil-btn--border"]},on:{click:e.toggleHaveBeenThere},scopedSlots:e._u([{key:"after-link",fn:function(){return[e.isOpenPopup?n("portal",{attrs:{to:"wil-modal"}},[n("wil-have-been-there-popup",{attrs:{msg:e.popupMsg},on:{close:function(t){e.isOpenPopup=!1}}})],1):e._e()]},proxy:!0}])})};o._withStripped=!0;var s={name:"wil-have-been-there-btn",data:function(){return{isOpenPopup:!1,isLoading:!1,popupMsg:"",toggleChecked:!1,count:""}},components:{WilHaveBeenTherePopup:function(){return n.e(67).then(n.bind(null,647))}},watch:{isOpenPopup:function(e){e||this.$emit("close")}},methods:{fetchCount:function(){var e=this;jQuery.ajax({type:"GET",url:WILOKE_GLOBAL.ajaxurl,data:{postId:this.postId,action:"wilcity_count_have_been_there"},success:function(t){t.success&&(e.count=t.data.count)}})},toggleHaveBeenThere:function(){var e=this;this.isLoading=!0,jQuery.ajax({type:"POST",url:WILOKE_GLOBAL.ajaxurl,data:{postId:this.postId,action:"wilcity_update_have_been_there",security:WILOKE_INLINE_GLOBAL.security},success:function(t){t.success?("checked"==t.data.status?(e.toggleChecked="yes","yes"==t.data.isReviewAllowed&&(e.popupMsg=t.data.popupMsg,e.isOpenPopup=!0)):e.toggleChecked="no",t.data.count&&(e.count=t.data.count)):alert(t.data.msg)}}).always((function(){return e.isLoading=!1}))}},computed:{btnName:function(){var e="yes"===this.toggleChecked?this.$options.filters.filterTranslation("haveBeenThere"):this.$options.filters.filterTranslation("askHaveBeenThere");return this.count&&(e="".concat(e," (").concat(this.count,")")),e}},created:function(){this.toggleChecked=this.isMeChecked,this.count=this.defaultCount},mounted:function(){var e=this;setTimeout((function(){e.fetchCount()}),5e3)},props:{wrapperClasses:{type:String,default:"wil-btn wil-btn--round wil-btn--sm"},icon:{type:String,default:"la la-map-pin color-1"},postId:{type:Number,required:!0},isMeChecked:{type:String,default:"no"},defaultCount:{type:String,default:""}}},a=n(0),i=Object(a.a)(s,o,[],!1,null,null,null);i.options.__file="assets/dev/js/components/smart/HaveBeenThere/WilHaveBeenThereBtn.vue";t.default=i.exports}},0,[67]]);